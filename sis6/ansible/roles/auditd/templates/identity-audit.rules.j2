## Identity and Access Management Audit Rules
## Managed by Ansible - SIS6

# ============================================================================
# USER/GROUP DATABASE CHANGES
# ============================================================================

# Monitor password file changes
-w /etc/passwd -p wa -k identity_changes

# Monitor group file changes  
-w /etc/group -p wa -k identity_changes

# Monitor shadow password file
-w /etc/shadow -p wa -k identity_changes

# Monitor group shadow file
-w /etc/gshadow -p wa -k identity_changes

# Monitor login.defs
-w /etc/login.defs -p wa -k identity_changes

# ============================================================================
# PAM CONFIGURATION
# ============================================================================

# Monitor PAM configuration directory
-w /etc/pam.d -p wa -k pam_changes

# Monitor PAM security configuration
-w /etc/security -p wa -k pam_changes

# Monitor nsswitch configuration
-w /etc/nsswitch.conf -p wa -k nss_changes

# ============================================================================
# SSH CONFIGURATION
# ============================================================================

# Monitor SSH daemon configuration
-w /etc/ssh/sshd_config -p wa -k ssh_config_changes

# Monitor SSH client configuration
-w /etc/ssh/ssh_config -p wa -k ssh_config_changes

# Monitor SSH authorized keys locations
-w /root/.ssh -p wa -k ssh_key_changes
-w /home -p wa -k user_home_changes

